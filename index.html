<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apollo Digital Workplace Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        apollo: '#E31E24',
                        primary: '#1e3a8a',
                        secondary: '#64748b',
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f3f4f6; }
        .card { transition: all 0.2s; }
        .card:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
        
        .tab-button {
            padding: 12px 24px;
            border-radius: 12px;
            border: 2px solid transparent;
            font-weight: 700;
            color: #475569;
            transition: all 0.3s;
            background-color: #e2e8f0;
            margin: 0 4px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .tab-button:hover {
            background-color: #cbd5e1;
            color: #1e3a8a;
        }
        .tab-button.tab-active {
            background-color: #1e3a8a;
            color: white;
            border-color: #1e3a8a;
            box-shadow: 0 4px 10px rgba(30, 58, 138, 0.3);
        }
        
        /* Tooltip & Badge Logic */
        .badge { 
            font-size: 0.75rem; 
            padding: 0.2rem 0.6rem; 
            border-radius: 0.375rem; 
            white-space: nowrap; 
            margin-right: 4px; 
            margin-bottom: 4px; 
            display: inline-block; 
            font-weight: 600; 
            position: relative;
            cursor: help;
        }
        
        /* Custom Tooltip Styling */
        .badge .tooltip {
            visibility: hidden;
            width: 180px;
            background-color: #1e293b;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 50;
            bottom: 125%;
            left: 50%;
            margin-left: -90px;
            opacity: 0;
            transition: opacity 0.2s;
            font-size: 0.7rem;
            line-height: 1.2;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2);
            pointer-events: none;
        }
        .badge .tooltip::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #1e293b transparent transparent transparent;
        }
        .badge:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }

        .badge-platform { background-color: #dbeafe; color: #1e40af; border: 1px solid #bfdbfe; }
        .badge-utility { background-color: #f3f4f6; color: #374151; border: 1px solid #e5e7eb; }
        .badge-chat { background-color: #dcfce7; color: #166534; border: 1px solid #bbf7d0; }
        .badge-business { background-color: #fce7f3; color: #9d174d; border: 1px solid #fbcfe8; }
    </style>
</head>
<body>

    <header class="bg-white shadow-sm sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-5 flex flex-col sm:flex-row justify-between items-center text-center sm:text-left">
            <div class="flex items-center gap-3 mb-2 sm:mb-0">
                <div class="flex flex-col items-center sm:items-start border-l-4 border-apollo pl-4">
                    <h1 class="text-2xl font-black text-gray-900 tracking-tight uppercase">Digital Workplace Report</h1>
                    <p class="text-xs text-gray-500 font-bold uppercase tracking-widest">Apollo Group | Dữ liệu: 12/2025</p>
                </div>
            </div>
            <div class="px-4 py-2 bg-blue-50 text-blue-800 rounded-full font-bold text-sm border border-blue-100 shadow-sm">
                <i class="fa-solid fa-user-shield mr-2"></i>Ban CNTT
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- Tabs -->
        <div class="flex flex-wrap justify-center mb-10 gap-2">
            <button onclick="switchView('department')" id="tab-dept" class="tab-button tab-active">
                <i class="fa-solid fa-building-user text-lg"></i> Thống kê theo Phòng Ban
            </button>
            <button onclick="switchView('category')" id="tab-cat" class="tab-button">
                <i class="fa-solid fa-layer-group text-lg"></i> Thống kê theo Loại App
            </button>
        </div>

        <!-- View 1: By Department -->
        <div id="view-department" class="block animate-fade-in">
            <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6" id="dept-grid"></div>
        </div>

        <!-- View 2: By Category -->
        <div id="view-category" class="hidden animate-fade-in">
            <div class="grid grid-cols-1 gap-8">
                <div class="bg-white rounded-xl shadow-sm p-6 border border-slate-100">
                    <h3 class="text-lg font-bold text-blue-800 mb-5 flex items-center gap-2 border-b pb-3"><i class="fa-brands fa-windows"></i> Phần mềm Nền tảng (Platform)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="cat-platform"></div>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-6 border border-slate-100">
                    <h3 class="text-lg font-bold text-slate-600 mb-5 flex items-center gap-2 border-b pb-3"><i class="fa-solid fa-toolbox"></i> Phần mềm Tiện ích (Utilities)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" id="cat-utility"></div>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-6 border border-slate-100">
                    <h3 class="text-lg font-bold text-green-700 mb-5 flex items-center gap-2 border-b pb-3"><i class="fa-solid fa-comments"></i> Phần mềm Chat & Collaboration</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" id="cat-chat"></div>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-6 border border-slate-100">
                    <h3 class="text-lg font-bold text-purple-700 mb-5 flex items-center gap-2 border-b pb-3"><i class="fa-solid fa-rocket"></i> Phần mềm Nghiệp vụ (Specialized)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="cat-business"></div>
                </div>
            </div>
        </div>

    </main>

    <footer class="bg-white border-t mt-16 py-8">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-sm font-bold text-slate-400 uppercase tracking-tighter">&copy; 2025 APOLLO INTERNAL REPORT. POWERED BY IT DEPARTMENT.</p>
        </div>
    </footer>

    <script>
        // --- 1. APP DESCRIPTIONS (Mô tả nhanh) ---
        const APP_INFO = {
            "Edge": "Trình duyệt Web của Microsoft",
            "MS Teams": "Làm việc cộng tác, họp và chat nhóm",
            "Office": "Outlook, Word, Excel, PowerPoint",
            "MS Office": "Outlook, Word, Excel, PowerPoint",
            "Chrome": "Trình duyệt Web Google Chrome",
            "Fast Online": "Phần mềm ERP FAST phiên bản Web",
            "Base Wework": "Phần mềm quản lý công việc và dự án",
            "Foxit Reader": "Phần mềm xem và in file PDF",
            "Unikey": "Phần mềm gõ tiếng Việt phổ biến",
            "Winrar": "Phần mềm nén và giải nén file",
            "X-Change PDF Editor": "Phần mềm đọc, cắt và chỉnh sửa PDF",
            "EVKey": "Phần mềm gõ tiếng Việt (Tương tự Unikey)",
            "Hibit Uninstaller": "Phần mềm gỡ cài đặt sạch tận gốc",
            "Ultraview": "Phần mềm điều khiển máy tính từ xa",
            "Zalo": "Phần mềm nhắn tin phổ biến nhất",
            "Whatsapp": "Phần mềm nhắn tin quốc tế",
            "Viber": "Phần mềm nhắn tin nội bộ",
            "Wechat": "Phần mềm chat làm việc với đối tác TQ",
            "Kakao Talk": "Phần mềm chat làm việc với đối tác HQ",
            "Adobe Photoshop": "Phần mềm thiết kế & chỉnh sửa ảnh",
            "PowerBI": "Hệ thống báo cáo quản trị thông minh",
            "Adobe Acrobat": "Chỉnh sửa PDF chuyên nghiệp",
            "Autocad": "Thiết kế kỹ thuật 2D/3D chuyên sâu",
            "Fast Offline": "Phần mềm kế toán FAST cài đặt máy",
            "HTKK": "Hệ thống hỗ trợ kê khai thuế",
            "iTax Viewer": "Phần mềm đọc hồ sơ thuế định dạng XML",
            "3DS Max": "Phần mềm thiết kế 3D chuyên nghiệp",
            "ECUSS": "Phần mềm khai báo Hải quan",
            "VNACCS": "Hệ thống thông quan Hải quan tự động",
            "Spyder (python)": "Môi trường lập trình Python phân tích dữ liệu",
            "SQL Server Management Studio": "Phần mềm quản trị cơ sở dữ liệu SQL",
            "SQL SSMS": "Phần mềm quản trị cơ sở dữ liệu SQL",
            "Spyder": "Môi trường lập trình Python",
            "Wise Eye Mix3": "Phần mềm quản lý máy chấm công",
            "iBHXH": "Phần mềm bảo hiểm xã hội",
            "TS24Pro": "Giải pháp kê khai trực tuyến",
            "Chữ kí số": "Thiết bị/PM ký điện tử",
            "Sketchup": "Phần mềm thiết kế kiến trúc 3D",
            "Winbox": "Công cụ quản lý Router Mikrotik chuyên dụng",
            "Advanced IP Scanner": "Phần mềm quét và phân tích địa chỉ IP",
            "Sophos Connect": "Phần mềm kết nối VPN Sophos Client",
            "Virtualbox": "Phần mềm tạo và quản lý máy ảo"
        };

        // --- 2. CONFIGURATION ---
        const SORT_ORDER = {
            platform: ['MS Teams', 'Office', 'MS Office', 'Outlook', 'Edge', 'Chrome', 'Base Wework'], 
            utility: ['Unikey', 'EVKey', 'Winrar', 'Foxit Reader', 'Hibit Uninstaller', 'Ultraview', 'X-Change PDF Editor'],
            chat: ['Zalo', 'Whatsapp', 'Viber', 'Wechat', 'Kakao Talk']
        };

        const COMMON_UTILITIES = ['Unikey', 'Winrar', 'Foxit Reader', 'Hibit Uninstaller', 'Ultraview'];

        function sortApps(apps, orderList) {
            if (!apps) return [];
            return [...apps].sort((a, b) => {
                let indexA = orderList.indexOf(a);
                let indexB = orderList.indexOf(b);
                if (indexA === -1) indexA = 999;
                if (indexB === -1) indexB = 999;
                return indexA - indexB;
            });
        }

        // --- 3. RAW DATA (Synced with CSV) ---
        let departments = [
            {
                name: "Ban Thư Ký",
                icon: "fa-pen-nib",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome", "Base Wework"],
                utility: [...COMMON_UTILITIES],
                chat: ["Zalo", "Whatsapp", "Viber"],
                business: ["Fast Online", "PowerBI"],
                license: "M365 Basic, Base"
            },
            {
                name: "Dược",
                icon: "fa-pills",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome", "Base Wework"],
                utility: [...COMMON_UTILITIES],
                chat: ["Zalo"],
                business: [], // Đã bỏ Fast Online theo yêu cầu
                license: "M365 Basic, Base"
            },
            {
                name: "HCNS - Hành Chính",
                icon: "fa-user-shield",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome", "Base Wework"],
                utility: [...COMMON_UTILITIES],
                chat: ["Zalo", "Whatsapp", "Viber"],
                business: ["Fast Online", "Wise Eye Mix3"],
                license: "M365 Basic, Base"
            },
            {
                name: "HCNS - Tuyển Dụng và C&B",
                icon: "fa-users-gear",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome"],
                utility: [...COMMON_UTILITIES],
                chat: ["Zalo", "Whatsapp"],
                business: ["Fast Online", "TS24Pro", "iBHXH", "HTKK", "Wise Eye Mix3"],
                license: "M365 Basic"
            },
            {
                name: "Phòng QLHT",
                icon: "fa-server",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome", "Base Wework"],
                utility: [...COMMON_UTILITIES],
                chat: ["Zalo", "Whatsapp", "Viber"],
                business: ["Fast Online"],
                license: "M365 Basic, Base"
            },
            {
                name: "Ban CNTT", // Cập nhật danh sách chính xác cho Ban CNTT
                icon: "fa-laptop-code",
                platform: ["Chrome", "Edge", "Fast Online", "MS Teams", "MS Office"],
                utility: ["Foxit Reader", "Unikey", "Winrar", "X-Change PDF Editor"],
                chat: ["Zalo", "Whatsapp"],
                business: ["Adobe Acrobat", "Adobe Photoshop", "Autocad", "Winbox", "Advanced IP Scanner", "Sophos Connect", "Virtualbox", "Wise Eye Mix3"],
                license: "M365 Basic, Base"
            },
            {
                name: "Kinh Doanh",
                icon: "fa-briefcase",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome", "Base Wework"],
                utility: [...COMMON_UTILITIES],
                chat: ["Zalo", "Whatsapp", "Viber"],
                business: ["Fast Online"],
                license: "M365 Basic, Base"
            },
            {
                name: "Kế Toán",
                icon: "fa-calculator",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome"],
                utility: [...COMMON_UTILITIES, "EVKey"], // Đã bổ sung EVKey
                chat: ["Zalo", "Whatsapp"],
                business: ["Fast Online", "Fast Offline", "MISA", "HTKK", "iTax Viewer", "Chữ kí số"],
                license: "M365 Basic"
            },
            {
                name: "Tài Chính",
                icon: "fa-chart-line",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome"],
                utility: [...COMMON_UTILITIES, "EVKey"], // Đã bổ sung EVKey
                chat: ["Zalo", "Whatsapp"],
                business: ["Fast Online", "Fast Offline", "Chữ kí số"],
                license: "M365 Basic"
            },
            {
                name: "Ngoại Thương",
                icon: "fa-globe",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome", "Base Wework"],
                utility: [...COMMON_UTILITIES],
                chat: ["Zalo", "Whatsapp", "Viber", "Wechat", "Kakao Talk"],
                business: ["Fast Online", "Adobe Acrobat", "Adobe Photoshop", "ECUSS", "VNACCS"],
                license: "M365 Basic, Base"
            },
            {
                name: "PTKD (General)",
                icon: "fa-search-dollar",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome", "Base Wework"],
                utility: [...COMMON_UTILITIES],
                chat: ["Zalo", "Whatsapp"],
                business: ["Fast Online", "PowerBI", "Spyder (python)", "SQL Server Management Studio"],
                license: "M365 Basic, Base"
            },
            {
                name: "PTKD - BA",
                icon: "fa-laptop-code",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome", "Base Wework"],
                utility: [...COMMON_UTILITIES],
                chat: ["Zalo", "Whatsapp"],
                business: ["Fast Online", "PowerBI", "SQL SSMS", "Spyder"],
                license: "M365 Basic, Base"
            },
            {
                name: "PTKD - Thị Trường",
                icon: "fa-store",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome", "Base Wework"],
                utility: [...COMMON_UTILITIES],
                chat: ["Zalo", "Whatsapp"],
                business: ["Fast Online"],
                license: "M365 Basic, Base"
            },
            {
                name: "Thu Mua - Office",
                icon: "fa-shopping-cart",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome", "Base Wework"],
                utility: [...COMMON_UTILITIES, "X-Change PDF Editor"],
                chat: ["Zalo", "Whatsapp"],
                business: ["Fast Online", "Autocad", "X-Change PDF Editor"],
                license: "M365 Basic, Base"
            },
            {
                name: "Thu Mua - Xây Dựng",
                icon: "fa-hard-hat",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome", "Base Wework"],
                utility: [...COMMON_UTILITIES],
                chat: ["Zalo", "Whatsapp"],
                business: ["Fast Online", "3DS Max", "Adobe Photoshop", "Autocad", "Sketchup"],
                license: "M365 Basic, Base"
            },
            {
                name: "Marketing (MKT)",
                icon: "fa-bullhorn",
                platform: ["MS Teams", "Office", "Outlook", "Edge", "Chrome", "Base Wework"],
                utility: [...COMMON_UTILITIES],
                chat: ["Zalo", "Whatsapp", "Viber"],
                business: ["Fast Online", "Adobe Photoshop"],
                license: "M365 Basic, Base"
            }
        ];

        // --- 4. RENDER LOGIC ---
        function renderDepartments() {
            const container = document.getElementById('dept-grid');
            container.innerHTML = '';
            
            const sortedDepartments = [...departments].sort((a, b) => a.name.localeCompare(b.name, 'vi', { sensitivity: 'base' }));

            sortedDepartments.forEach(dept => {
                const card = document.createElement('div');
                card.className = 'card bg-white rounded-xl shadow-sm border border-slate-100 p-6 flex flex-col h-full';
                
                const genBadges = (list, type) => (list || []).map(item => {
                    const desc = APP_INFO[item] || APP_INFO[item.split(' (')[0]] || "Ứng dụng doanh nghiệp";
                    return `<span class="badge badge-${type}">
                                ${item}
                                <span class="tooltip">${desc}</span>
                            </span>`;
                }).join('');

                const sortedPlatform = sortApps(dept.platform, SORT_ORDER.platform);
                const sortedUtility = sortApps(dept.utility, SORT_ORDER.utility);
                const sortedChat = sortApps(dept.chat, SORT_ORDER.chat);
                
                let businessList = [...(dept.business || [])];
                let foIdx = businessList.indexOf("Fast Online");
                if (foIdx > -1) {
                    businessList.splice(foIdx, 1);
                    businessList.sort();
                    businessList.unshift("Fast Online");
                } else { businessList.sort(); }

                card.innerHTML = `
                    <div class="flex items-center gap-4 mb-5 border-b pb-4">
                        <div class="w-12 h-12 rounded-xl bg-slate-100 flex items-center justify-center text-primary shrink-0 text-xl">
                            <i class="fa-solid ${dept.icon}"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-gray-800 text-lg">${dept.name}</h3>
                            <div class="text-[11px] mt-0.5 text-gray-400 font-bold uppercase tracking-tighter">License: <span class="text-apollo">${dept.license}</span></div>
                        </div>
                    </div>
                    
                    <div class="space-y-4 text-sm flex-grow">
                        <div>
                            <p class="text-[10px] font-black text-blue-900 uppercase mb-2 tracking-widest flex items-center gap-1">
                                <i class="fa-brands fa-windows"></i> Nền tảng
                            </p>
                            <div class="leading-relaxed">
                                <div class="mb-1">${genBadges(sortedPlatform, 'platform')}</div>
                                <div>${genBadges(sortedUtility, 'utility')}</div>
                            </div>
                        </div>
                        <div class="border-t border-dashed border-slate-100 pt-3">
                            <p class="text-[10px] font-black text-green-800 uppercase mb-2 tracking-widest flex items-center gap-1">
                                <i class="fa-solid fa-comments"></i> Liên lạc
                            </p>
                            <div class="leading-relaxed">${genBadges(sortedChat, 'chat')}</div>
                        </div>
                        ${businessList.length > 0 ? `
                        <div class="border-t border-dashed border-slate-100 pt-3">
                            <p class="text-[10px] font-black text-purple-800 uppercase mb-2 tracking-widest flex items-center gap-1">
                                <i class="fa-solid fa-briefcase"></i> Nghiệp vụ
                            </p>
                            <div class="leading-relaxed">${genBadges(businessList, 'business')}</div>
                        </div>` : ''}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function renderCategories() {
            const categories = { platform: {}, chat: {}, business: {}, utility: {} };
            const countApp = (type, appName, deptName) => {
                if (!categories[type][appName]) categories[type][appName] = [];
                categories[type][appName].push(deptName);
            };

            departments.forEach(d => {
                (d.platform || []).forEach(app => countApp('platform', app, d.name));
                (d.chat || []).forEach(app => countApp('chat', app, d.name));
                (d.business || []).forEach(app => countApp('business', app, d.name));
                (d.utility || []).forEach(app => countApp('utility', app, d.name));
            });

            const renderSection = (type, elementId) => {
                const container = document.getElementById(elementId);
                container.innerHTML = '';
                let appArray = Object.keys(categories[type]).map(app => ({
                    name: app,
                    depts: categories[type][app],
                    count: categories[type][app].length
                }));
                appArray.sort((a, b) => b.count - a.count);

                appArray.forEach(appData => {
                    const desc = APP_INFO[appData.name] || APP_INFO[appData.name.split(' (')[0]] || "Ứng dụng doanh nghiệp";
                    const isAll = appArray.length > 1 && appData.count > departments.length / 2;
                    
                    const item = document.createElement('div');
                    item.className = 'border border-slate-100 rounded-lg p-3 hover:bg-blue-50/30 transition-colors relative cursor-help group';
                    item.innerHTML = `
                        <div class="flex justify-between items-start mb-2">
                            <span class="font-bold text-gray-800 text-sm">${appData.name}</span>
                            <span class="text-[10px] font-black bg-slate-200 px-2 py-0.5 rounded text-slate-600">${appData.count}</span>
                        </div>
                        <div class="text-[11px] text-gray-500 leading-tight">
                            ${isAll ? '<span class="italic text-blue-600 font-bold">Toàn bộ công ty</span>' : appData.depts.join(', ')}
                        </div>
                        <div class="tooltip opacity-0 group-hover:opacity-100 absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-48 bg-slate-800 text-white text-[10px] p-2 rounded shadow-lg pointer-events-none transition-opacity z-50 text-center">
                            ${desc}
                            <div class="absolute top-full left-1/2 -translate-x-1/2 border-8 border-transparent border-t-slate-800"></div>
                        </div>
                    `;
                    container.appendChild(item);
                });
            };

            renderSection('platform', 'cat-platform');
            renderSection('utility', 'cat-utility');
            renderSection('chat', 'cat-chat');
            renderSection('business', 'cat-business');
        }

        function switchView(viewName) {
            const deptView = document.getElementById('view-department');
            const catView = document.getElementById('view-category');
            const tabDept = document.getElementById('tab-dept');
            const tabCat = document.getElementById('tab-cat');

            if (viewName === 'department') {
                deptView.classList.remove('hidden'); catView.classList.add('hidden');
                tabDept.classList.add('tab-active'); tabCat.classList.remove('tab-active');
            } else {
                deptView.classList.add('hidden'); catView.classList.remove('hidden');
                tabCat.classList.add('tab-active'); tabDept.classList.remove('tab-active');
            }
        }

        window.onload = function() {
            renderDepartments();
            renderCategories();
        };
    </script>
</body>
</html>
